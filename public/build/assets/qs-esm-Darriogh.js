const oe=String.prototype.replace,ie=/%20/g,U={RFC1738:"RFC1738",RFC3986:"RFC3986"},K={RFC1738:function(r){return oe.call(r,ie,"+")},RFC3986:function(r){return String(r)}},le=U.RFC1738,q=U.RFC3986,v=Object.prototype.hasOwnProperty,O=Array.isArray,C=new WeakMap;var G=function(e,t){return C.set(e,t),e};function P(r){return C.has(r)}var z=function(e){return C.get(e)},J=function(e,t){C.set(e,t)};const j=function(){const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),ce=function(e){for(;e.length>1;){const t=e.pop(),n=t.obj[t.prop];if(O(n)){const o=[];for(let a=0;a<n.length;++a)typeof n[a]<"u"&&o.push(n[a]);t.obj[t.prop]=o}}},X=function(e,t){const n=t&&t.plainObjects?Object.create(null):{};for(let o=0;o<e.length;++o)typeof e[o]<"u"&&(n[o]=e[o]);return n},fe=function r(e,t,n){if(!t)return e;if(typeof t!="object"){if(O(e))e.push(t);else if(e&&typeof e=="object")if(P(e)){var o=z(e)+1;e[o]=t,J(e,o)}else(n&&(n.plainObjects||n.allowPrototypes)||!v.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object"){if(P(t)){for(var a=Object.keys(t),l=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},u=0;u<a.length;u++){var f=parseInt(a[u],10);l[f+1]=t[a[u]]}return G(l,z(t)+1)}return[e].concat(t)}let s=e;return O(e)&&!O(t)&&(s=X(e,n)),O(e)&&O(t)?(t.forEach(function(i,d){if(v.call(e,d)){const c=e[d];c&&typeof c=="object"&&i&&typeof i=="object"?e[d]=r(c,i,n):e.push(i)}else e[d]=i}),e):Object.keys(t).reduce(function(i,d){const c=t[d];return v.call(i,d)?i[d]=r(i[d],c,n):i[d]=c,i},s)},ae=function(r,e,t){const n=r.replace(/\+/g," ");if(t==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},_=1024,se=function(e,t,n,o,a){if(e.length===0)return e;let l=e;if(typeof e=="symbol"?l=Symbol.prototype.toString.call(e):typeof e!="string"&&(l=String(e)),n==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});let u="";for(let f=0;f<l.length;f+=_){const s=l.length>=_?l.slice(f,f+_):l,i=[];for(let d=0;d<s.length;++d){let c=s.charCodeAt(d);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||a===le&&(c===40||c===41)){i[i.length]=s.charAt(d);continue}if(c<128){i[i.length]=j[c];continue}if(c<2048){i[i.length]=j[192|c>>6]+j[128|c&63];continue}if(c<55296||c>=57344){i[i.length]=j[224|c>>12]+j[128|c>>6&63]+j[128|c&63];continue}d+=1,c=65536+((c&1023)<<10|s.charCodeAt(d)&1023),i[i.length]=j[240|c>>18]+j[128|c>>12&63]+j[128|c>>6&63]+j[128|c&63]}u+=i.join("")}return u},ue=function(e){const t=[{obj:{o:e},prop:"o"}],n=[];for(let o=0;o<t.length;++o){const a=t[o],l=a.obj[a.prop],u=Object.keys(l);for(let f=0;f<u.length;++f){const s=u[f],i=l[s];typeof i=="object"&&i!==null&&n.indexOf(i)===-1&&(t.push({obj:l,prop:s}),n.push(i))}}return ce(t),e},de=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Y=function(e,t,n,o){if(P(e)){var a=z(e)+1;return e[a]=t,J(e,a),e}var l=[].concat(e,t);return l.length>n?G(X(l,{plainObjects:o}),l.length-1):l},M=function(e,t){if(O(e)){const n=[];for(let o=0;o<e.length;o+=1)n.push(t(e[o]));return n}return t(e)},ye=Object.prototype.hasOwnProperty,Z={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},g=Array.isArray,pe=Array.prototype.push,ee=function(r,e){pe.apply(r,g(e)?e:[e])},me=Date.prototype.toISOString,W=q,p={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:se,encodeValuesOnly:!1,format:W,formatter:K[W],indices:!1,serializeDate:function(e){return me.call(e)},skipNulls:!1,strictNullHandling:!1},he=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Q={},te=function(e,t,n,o,a,l,u,f,s,i,d,c,b,m,x,w,E,F){let y=e,A=F,D=0,B=!1;for(;(A=A.get(Q))!==void 0&&!B;){const h=A.get(e);if(D+=1,typeof h<"u"){if(h===D)throw new RangeError("Cyclic object value");B=!0}typeof A.get(Q)>"u"&&(D=0)}if(typeof i=="function"?y=i(t,y):y instanceof Date?y=b(y):n==="comma"&&g(y)&&(y=M(y,function(h){return h instanceof Date?b(h):h})),y===null){if(l)return s&&!w?s(t,p.encoder,E,"key",m):t;y=""}if(he(y)||de(y)){if(s){const h=w?t:s(t,p.encoder,E,"key",m);return[x(h)+"="+x(s(y,p.encoder,E,"value",m))]}return[x(t)+"="+x(String(y))]}const R=[];if(typeof y>"u")return R;let S;if(n==="comma"&&g(y))w&&s&&(y=M(y,s)),S=[{value:y.length>0?y.join(",")||null:void 0}];else if(g(i))S=i;else{const h=Object.keys(y);S=d?h.sort(d):h}const L=f?t.replace(/\./g,"%2E"):t,N=o&&g(y)&&y.length===1?L+"[]":L;if(a&&g(y)&&y.length===0)return N+"[]";for(let h=0;h<S.length;++h){const k=S[h],$=typeof k=="object"&&typeof k.value<"u"?k.value:y[k];if(u&&$===null)continue;const T=c&&f?k.replace(/\./g,"%2E"):k,re=g(y)?typeof n=="function"?n(N,T):N:N+(c?"."+T:"["+T+"]");F.set(e,D);const V=new WeakMap;V.set(Q,F),ee(R,te($,re,n,o,a,l,u,f,n==="comma"&&w&&g(y)?null:s,i,d,c,b,m,x,w,E,V))}return R},be=function(e){if(!e)return p;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||p.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=q;if(typeof e.format<"u"){if(!ye.call(K,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const o=K[n];let a=p.filter;(typeof e.filter=="function"||g(e.filter))&&(a=e.filter);let l;if(e.arrayFormat in Z?l=e.arrayFormat:"indices"in e?l=e.indices?"indices":"repeat":l=p.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const u=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:p.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:p.addQueryPrefix,allowDots:u,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:p.allowEmptyArrays,arrayFormat:l,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:p.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?p.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:p.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:p.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:p.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:p.encodeValuesOnly,filter:a,format:n,formatter:o,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:p.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:p.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:p.strictNullHandling}};function Ae(r,e){let t=r;const n=be(e);let o,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):g(n.filter)&&(a=n.filter,o=a);const l=[];if(typeof t!="object"||t===null)return"";const u=Z[n.arrayFormat],f=u==="comma"&&n.commaRoundTrip;o||(o=Object.keys(t)),n.sort&&o.sort(n.sort);const s=new WeakMap;for(let c=0;c<o.length;++c){const b=o[c];n.skipNulls&&t[b]===null||ee(l,te(t[b],b,u,f,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,s))}const i=l.join(n.delimiter);let d=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),i.length>0?d+i:""}const H=Object.prototype.hasOwnProperty,je=Array.isArray,I={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:ae,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ge=function(r){return r.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},ne=function(r,e){return r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1?r.split(","):r},xe="utf8=%26%2310003%3B",we="utf8=%E2%9C%93",Oe=function(e,t){const n={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=t.parameterLimit===1/0?void 0:t.parameterLimit,l=o.split(t.delimiter,a);let u=-1,f,s=t.charset;if(t.charsetSentinel)for(f=0;f<l.length;++f)l[f].indexOf("utf8=")===0&&(l[f]===we?s="utf-8":l[f]===xe&&(s="iso-8859-1"),u=f,f=l.length);for(f=0;f<l.length;++f){if(f===u)continue;const i=l[f],d=i.indexOf("]="),c=d===-1?i.indexOf("="):d+1;let b,m;c===-1?(b=t.decoder(i,I.decoder,s,"key"),m=t.strictNullHandling?null:""):(b=t.decoder(i.slice(0,c),I.decoder,s,"key"),m=M(ne(i.slice(c+1),t),function(w){return t.decoder(w,I.decoder,s,"value")})),m&&t.interpretNumericEntities&&s==="iso-8859-1"&&(m=ge(m)),i.indexOf("[]=")>-1&&(m=je(m)?[m]:m);const x=H.call(n,b);x&&t.duplicates==="combine"?n[b]=Y(n[b],m,t.arrayLimit,t.plainObjects):(!x||t.duplicates==="last")&&(n[b]=m)}return n},ke=function(r,e,t,n){let o=n?e:ne(e,t);for(let a=r.length-1;a>=0;--a){let l;const u=r[a];if(u==="[]"&&t.parseArrays)P(o)?l=o:l=t.allowEmptyArrays&&(o===""||t.strictNullHandling&&o===null)?[]:Y([],o,t.arrayLimit,t.plainObjects);else{l=t.plainObjects?Object.create(null):{};const f=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,s=t.decodeDotInKeys?f.replace(/%2E/g,"."):f,i=parseInt(s,10);!t.parseArrays&&s===""?l={0:o}:!isNaN(i)&&u!==s&&String(i)===s&&i>=0&&t.parseArrays&&i<=t.arrayLimit?(l=[],l[i]=o):s!=="__proto__"&&(l[s]=o)}o=l}return o},Se=function(e,t,n,o){if(!e)return;const a=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,l=/(\[[^[\]]*])/,u=/(\[[^[\]]*])/g;let f=n.depth>0&&l.exec(a);const s=f?a.slice(0,f.index):a,i=[];if(s){if(!n.plainObjects&&H.call(Object.prototype,s)&&!n.allowPrototypes)return;i.push(s)}let d=0;for(;n.depth>0&&(f=u.exec(a))!==null&&d<n.depth;){if(d+=1,!n.plainObjects&&H.call(Object.prototype,f[1].slice(1,-1))&&!n.allowPrototypes)return;i.push(f[1])}return f&&i.push("["+a.slice(f.index)+"]"),ke(i,t,n,o)},Ee=function(e){return I};function De(r,e){const t=Ee();if(r===""||r===null||typeof r>"u")return t.plainObjects?Object.create(null):{};const n=typeof r=="string"?Oe(r,t):r;let o=t.plainObjects?Object.create(null):{};const a=Object.keys(n);for(let l=0;l<a.length;++l){const u=a[l],f=Se(u,n[u],t,typeof r=="string");o=fe(o,f,t)}return t.allowSparse===!0?o:ue(o)}export{De as p,Ae as s};
