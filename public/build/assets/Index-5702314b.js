import{_ as Z,S as T}from"./AppLayout-6f4f39c7.js";import{o as n,f as d,b as e,q as C,s as B,c as V,n as $,u as l,i as G,k as J,K as M,T as Q,l as x,N as W,F as X,m as Y,p as ee,a as i,w as A,Z as te,t as c,z as O,ab as N,v as ae,g as oe,O as _}from"./app-88308913.js";import{i as ne}from"./es.es-33a9c502.js";import{h as E}from"./moment-fbc5633a.js";import{s as S}from"./index-1049af69.js";import{s as se,e as le,a as re,b as ie}from"./index-ec64e22a.js";import"./logo-e22dfca4.js";import"./_plugin-vue_export-helper-c27b6911.js";const ce={id:"pagination",class:"w-full flex justify-center border-t border-gray-100 pt-4 items-center"},de={class:"flex flex-wrap -mb-1"},ue=["innerHTML"],me={__name:"Pagination",props:["elements"],setup(f){return(u,k)=>(n(),d("div",ce,[e("div",de,[(n(!0),d(C,null,B(f.elements.links,(r,w)=>(n(),d(C,{key:w},[r.url===null?(n(),d("div",{key:0,class:"mr-1 mb-1 px-3 py-3 text-sm leading-4 text-gray-400 border rounded",innerHTML:r.label},null,8,ue)):(n(),V(l(G),{key:1,class:$(["mr-1 mb-1 px-3 py-3 text-sm leading-4 border rounded hover:bg-gray-200 focus:border-primary-900 focus:text-gray-400",{"bg-primary-900 text-gray-400":r.active}]),href:r.url,innerHTML:r.label},null,8,["class","href","innerHTML"]))],64))),128))])]))}},pe={class:"card p-4 mb-4 bg-white col-span-12 rounded-lg shadow-lg 2xl:col-span-12"},fe={class:"px-3 pb-2 col-span-full flex justify-between items-center"},he={class:"align-middle py-4"},ve={class:"grid grid-cols-6 gap-4 m-1.5"},be={style:{overflow:"auto","max-height":"700px"}},xe={class:"w-full text-md bg-white shadow-md rounded mb-4"},_e=e("thead",{style:{position:"sticky"},class:"top-0 z-[1]"},[e("tr",{class:"bg-secondary-100"},[e("th",{class:"p-1.5"},"Fecha y Hora"),e("th",null,"Nº Compra"),e("th",null,"Cliente"),e("th",null,"Estado"),e("th",null,"Total"),e("th",null,"Observaciones"),e("th",null,"Acciones")])],-1),ge={class:"border text-center hover:cursor-pointer hover:bg-gray-100"},ye=["onClick"],Ce=["onClick"],we=["onClick"],De=["onClick"],ke=["onClick"],Te=e("i",{class:"fas fa-ban"},null,-1),D="Historial de Ventas",p="ventas",Ve={__name:"Index",props:{ventas:{type:Object,default:()=>({})},filtro:{type:Object,default:()=>({})}},setup(f){const u=f,k=J(),{permissions:r}=M().props.auth,{tipo_cambio:w}=M().props,F=Q({id:""}),L=[{text:"Hoy",onClick(){return[new Date,new Date]}},{text:"Ayer",onClick(){return[S(new Date,1),S(new Date,1)]}},{text:"Este mes",onClick(){return[se(new Date),le(new Date)]}},{text:"Este año",onClick(){return[re(new Date),ie(new Date)]}}];let m=x(u.filtro.buscar),s=x([u.filtro.inicio,u.filtro.fin]),g=x(u.filtro.inicio),y=x(u.filtro.fin);W(m,t=>{_.get(route(p+".index"),{buscar:t,inicio:g.value,fin:y.value},{preserveState:!0,replace:!0})});const H=t=>{console.log("vv",t),t[0]!=null&&t[1]!=null?(s.value=[E(t[0]).format("YYYY-MM-DD"),E(t[1]).format("YYYY-MM-DD")],g.value=s.value[0],y.value=s.value[1]):(s.value=[],g.value=null,y.value=null),_.get(route(p+".index"),{buscar:m.value,inicio:g.value,fin:y.value},{preserveState:!0,replace:!0})},I=t=>{switch(t){case"PENDIENTE DE FACTURACIÓN":return"text-orange-600";case"FACTURADO":return"text-blue-600";case"COMPLETADO":return"text-green-600";case"ANULADO":return"text-red-600";default:return"text-black"}},U=t=>{_.get(route(p+".show",t))},j=t=>{T.mixin({buttonsStyling:!0}).fire({width:350,title:"Seguro de Anular ",text:"Se anulará definitivamente",icon:"question",showCancelButton:!0,confirmButtonText:"Anular",cancelButtonText:"Cancelar",cancelButtonColor:"red",confirmButtonColor:"#2563EB"}).then(v=>{v.isConfirmed&&F.delete(route(p+".destroy",t),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{z("success","Eliminado","Se ha anulado"),setTimeout(()=>{_.get(route(p+".index"))},1e3)}})})},h=t=>{U(t)},z=(t,o,v)=>{k.add({severity:t,summary:o,detail:v,life:3e3})},P=()=>{w==!0?_.get(route(p+".create")):R("error","No se ha especificado el tipo de cambio para el día")},R=(t,o)=>{T.fire({width:350,title:o,icon:t})};return x({global:{value:null,matchMode:X.CONTAINS}}),(t,o)=>{const v=Y("Toast"),q=Y("InputText"),K=ee("tooltip");return n(),d(C,null,[i(l(te),{title:D}),i(Z,{pagina:[{label:D,link:!1}]},{default:A(()=>[e("div",pe,[i(v),e("div",fe,[e("h5",{class:"text-2xl font-medium"},c(D)),i(l(O),{size:"small",label:"Crear Venta",severity:"success",onClick:P})]),e("div",he,[e("div",ve,[i(q,{modelValue:l(m),"onUpdate:modelValue":o[0]||(o[0]=a=>N(m)?m.value=a:m=a),placeholder:"Buscar por N° Compra o Cliente",pt:{root:{class:"col-span-6 lg:col-span-2 m-1.5"}}},null,8,["modelValue"]),i(l(ne),{onChange:H,type:"date",range:"","value-type":"YYYY-MM-DD",format:"DD/MM/YYYY",class:"p-inputtext p-component col-span-6 lg:col-span-2 font-sans font-normal text-gray-700 bg-white transition-colors duration-200 border-0 text-sm",value:l(s),"onUpdate:value":o[1]||(o[1]=a=>N(s)?s.value=a:s=a),shortcuts:L,lang:"es",editable:"false",placeholder:"Seleccione Fecha"},null,8,["value"])]),e("div",be,[e("table",xe,[_e,e("tbody",null,[(n(!0),d(C,null,B(f.ventas.data,a=>(n(),d("tr",ge,[e("td",{onClick:b=>h(a.id)},c(a.fecha??""),9,ye),e("td",{onClick:b=>h(a.id)},c(a.nro_compra!="null"?a.nro_compra:""),9,Ce),e("td",{onClick:b=>h(a.id)},c(a.cliente!="null"?a.cliente:""),9,we),e("td",{onClick:b=>h(a.id),class:"p-1.5"},[e("span",{class:$(["font-semibold text-md",I(a.estado)])},c(a.estado??""),3)],8,De),e("td",null,c(a.total),1),e("td",{onClick:b=>h(a.id)},c(a.observaciones),9,ke),e("td",null,[l(r).includes("eliminar-ventas")&&a.estado!=="ANULADO"?ae((n(),V(l(O),{key:0,onClick:b=>j(a.id),class:"w-8 h-8 rounded border-red-700 bg-red-700 px-2 py-1 text-base font-normal text-white m-1 hover:bg-red-600"},{default:A(()=>[Te]),_:2},1032,["onClick"])),[[K,{value:"Anular",pt:{text:"bg-gray-500 p-1 text-xs text-white rounded"}},void 0,{top:!0}]]):oe("",!0)])]))),256))])])]),i(me,{elements:f.ventas},null,8,["elements"])])])]),_:1},8,["pagina"])],64)}}};export{Ve as default};
