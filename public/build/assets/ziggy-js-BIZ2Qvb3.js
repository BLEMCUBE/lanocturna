import{s as $,p as w}from"./qs-esm-Darriogh.js";function o(){return o=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},o.apply(null,arguments)}class f{constructor(e,t,r){var s,n;this.name=e,this.definition=t,this.bindings=(s=t.bindings)!=null?s:{},this.wheres=(n=t.wheres)!=null?n:{},this.config=r}get template(){const e=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return e===""?"/":e}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var e,t;return(e=(t=this.template.match(/{[^}?]+\??}/g))==null?void 0:t.map(r=>({name:r.replace(/{|\??}/g,""),required:!/\?}$/.test(r)})))!=null?e:[]}matchesUrl(e){var t;if(!this.definition.methods.includes("GET"))return!1;const r=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(u,m,g,d)=>{var h;const l=`(?<${g}>${((h=this.wheres[g])==null?void 0:h.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return d?`(${m}${l})?`:`${m}${l}`}).replace(/^\w+:\/\//,""),[s,n]=e.replace(/^\w+:\/\//,"").split("?"),i=(t=new RegExp(`^${r}/?$`).exec(s))!=null?t:new RegExp(`^${r}/?$`).exec(decodeURI(s));if(i){for(const u in i.groups)i.groups[u]=typeof i.groups[u]=="string"?decodeURIComponent(i.groups[u]):i.groups[u];return{params:i.groups,query:w(n)}}return!1}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(t,r,s)=>{var n,i;if(!s&&[null,void 0].includes(e[r]))throw new Error(`Ziggy error: '${r}' parameter is required for route '${this.name}'.`);if(this.wheres[r]&&!new RegExp(`^${s?`(${this.wheres[r]})?`:this.wheres[r]}$`).test((i=e[r])!=null?i:""))throw new Error(`Ziggy error: '${r}' parameter '${e[r]}' does not match required format '${this.wheres[r]}' for route '${this.name}'.`);return encodeURI((n=e[r])!=null?n:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class b extends String{constructor(e,t,r=!0,s){if(super(),this.t=s??(typeof Ziggy<"u"?Ziggy:globalThis?.Ziggy),!this.t&&typeof document<"u"&&document.getElementById("ziggy-routes-json")&&(globalThis.Ziggy=JSON.parse(document.getElementById("ziggy-routes-json").textContent),this.t=globalThis.Ziggy),this.t=o({},this.t,{absolute:r}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new f(e,this.t.routes[e],this.t),this.o=this.u(t)}}toString(){const e=Object.keys(this.o).filter(t=>!this.i.parameterSegments.some(({name:r})=>r===t)).filter(t=>t!=="_query").reduce((t,r)=>o({},t,{[r]:this.o[r]}),{});return this.i.compile(this.o)+$(o({},e,this.o._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(t,r)=>typeof t=="boolean"?Number(t):r(t)})}h(e){e?this.t.absolute&&e.startsWith("/")&&(e=this.l().host+e):e=this.m();let t={};const[r,s]=Object.entries(this.t.routes).find(([n,i])=>t=new f(n,i,this.t).matchesUrl(e))||[void 0,void 0];return o({name:r},t,{route:s})}m(){const{host:e,pathname:t,search:r}=this.l();return(this.t.absolute?e+t:t.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+r}current(e,t){const{name:r,params:s,query:n,route:i}=this.h();if(!e)return r;const u=new RegExp(`^${e.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(r);if([null,void 0].includes(t)||!u)return u;const m=new f(r,i,this.t);t=this.u(t,m);const g=o({},s,n);if(Object.values(t).every(h=>!h)&&!Object.values(g).some(h=>h!==void 0))return!0;const d=(h,l)=>Object.entries(h).every(([c,p])=>Array.isArray(p)&&Array.isArray(l[c])?p.every(y=>l[c].includes(y)||l[c].includes(decodeURIComponent(y))):typeof p=="object"&&typeof l[c]=="object"&&p!==null&&l[c]!==null?d(p,l[c]):l[c]==p||l[c]==decodeURIComponent(p));return d(t,g)}l(){var e,t,r,s,n,i;const{host:u="",pathname:m="",search:g=""}=typeof window<"u"?window.location:{};return{host:(e=(t=this.t.location)==null?void 0:t.host)!=null?e:u,pathname:(r=(s=this.t.location)==null?void 0:s.pathname)!=null?r:m,search:(n=(i=this.t.location)==null?void 0:i.search)!=null?n:g}}get params(){const{params:e,query:t}=this.h();return o({},e,t)}get routeParams(){return this.h().params}get queryParams(){return this.h().query}has(e){return this.t.routes.hasOwnProperty(e)}u(e={},t=this.i){e!=null||(e={}),e=["string","number"].includes(typeof e)?[e]:e;const r=t.parameterSegments.filter(({name:s})=>!this.t.defaults[s]);return Array.isArray(e)?e=e.reduce((s,n,i)=>o({},s,r[i]?{[r[i].name]:n}:typeof n=="object"?n:{[n]:""}),{}):r.length!==1||e[r[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[r[0].name]:e}),o({},this.p(t),this.$(e,t))}p(e){return e.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((t,{name:r},s)=>o({},t,{[r]:this.t.defaults[r]}),{})}$(e,{bindings:t,parameterSegments:r}){return Object.entries(e).reduce((s,[n,i])=>{if(!i||typeof i!="object"||Array.isArray(i)||!r.some(({name:u})=>u===n))return o({},s,{[n]:i});if(!i.hasOwnProperty(t[n])){if(!i.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${n}' parameter is missing route model binding key '${t[n]}'.`);t[n]="id"}return o({},s,{[n]:i[t[n]]})},{})}valueOf(){return this.toString()}}function v(a,e,t,r){const s=new b(a,e,t,r);return a?s.toString():s}const j={install(a,e){const t=(r,s,n,i=e)=>v(r,s,n,i);parseInt(a.version)>2?(a.config.globalProperties.route=t,a.provide("route",t)):a.mixin({methods:{route:t}})}};export{j as o};
