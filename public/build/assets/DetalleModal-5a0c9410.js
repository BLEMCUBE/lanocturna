import{r as g,o as R,O as h,P as T,g as f,S as x,V as v,E as e,f as c,j as t,z as y,A as n,F as V,v as $,Q as z,R as C,t as w,n as D,u as L}from"./@vue-1043e4d5.js";import{K as Y,T as k}from"./@inertiajs-ab1bf9dd.js";import{a as j}from"./axios-4a70c6fc.js";import"./vue-datepicker-next-31061510.js";import{h as G}from"./moment-fbc5633a.js";import"./deepmerge-34bd70bf.js";import"./apexcharts-f697a6eb.js";import"./qs-ba0d1d34.js";import"./side-channel-009c6bc3.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-0f5d75dd.js";import"./nprogress-a144f12f.js";import"./lodash.clonedeep-6a476b09.js";import"./lodash.isequal-cbdfea98.js";import"./date-format-parse-388037e5.js";const O={class:"px-2 pt-0 pb-0 grid grid-cols-12 gap-2 mb-2"},H={class:"col-span-12"},K=t("b",null,"Costo CIF: ",-1),Q=t("div",{class:"col-span-12"},[t("p",null,[t("b",null,"Pagos Ingresados: ")])],-1),U={class:"col-span-12"},q={class:"w-full border"},J=t("thead",null,[t("tr",{class:"w-full border text-[14px]"},[t("th",{class:"w-26 text-center border"}," Fecha "),t("th",{class:"text-center border"}," Banco "),t("th",{class:"text-center border"}," Nro. de Transacción "),t("th",{class:"text-center border"}," Monto "),t("th",{class:"text-center border"}," Acciones ")])],-1),W={class:"w-full text-center border text-xs"},X={class:"text-center border text-[14px]"},Z={class:"text-center border text-[14px]"},tt={class:"text-center border text-[14px]"},ot={class:"text-center border text-[14px]"},et={class:"text-center border text-[14px]"},st=t("i",{class:"fas fa-trash-alt text-[14px] text-center"},null,-1),at={class:"col-span-12 pt-2"},rt=t("b",null,"Saldo: ",-1),nt={class:"flex justify-end py-3"},A="pagos-importaciones",Ft={__name:"DetalleModal",props:{importacionId:{type:Number,default:null},showDetalle:{type:Boolean,default:!1}},emits:["pass-info"],setup(E,{emit:F}){const m=E,{permissions:I}=Y().props.auth,M=k({id:""}),u=g(!1),i=g("CANCELAR"),o=k({id:"",nro_carpeta:"",costo_cif:"",pagos:[],pagado:"",saldo:""}),N=a=>{M.delete(route(A+".destroy",a),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{b(m.importacionId),i.value="ELIMINADO",d()}})},B=()=>{i.value="AGREGAR",d()};R(()=>{b(m.importacionId)});function d(){F("pass-info",{store:i.value,importacionId:m.importacionId})}const b=a=>{j.get(route(A+".showdetalle",a)).then(p=>{var s=p.data.importacion;o.id=s.id,o.nro_carpeta=s.nro_carpeta,o.costo_cif=s.costo_cif,o.pagos=s.importaciones_pagos,o.pagado=s.importaciones_pagos.reduce((l,_)=>l+parseFloat(_.monto),0).toFixed(2),o.saldo=s.costo_cif-o.pagado,u.value=!0})},S=()=>{o.reset(),o.clearErrors(),i.value="CANCELAR",d()};return(a,p)=>{const s=h("Toast"),l=h("Button"),_=h("Dialog"),P=T("tooltip");return c(),f("section",null,[x(s),x(_,{visible:u.value,"onUpdate:visible":p[0]||(p[0]=r=>u.value=r),onHide:d,modal:"",header:`Pagos importación: ${e(o).nro_carpeta}`,style:{width:"40vw"},position:"top",pt:{header:{class:"mt-4 p-2"},content:{class:"p-2"}}},{default:v(()=>[t("form",null,[t("div",O,[t("div",H,[t("p",null,[K,y(" "+n(a.$numberFormat(e(o).costo_cif)),1)])]),Q,t("div",U,[t("table",q,[J,t("tbody",null,[(c(!0),f(V,null,$(e(o).pagos,r=>(c(),f("tr",W,[t("td",X,n(e(G)(r.fecha_pago).format("DD/MM/YYYY")),1),t("td",Z,n(r.banco),1),t("td",tt,n(r.nro_transaccion),1),t("td",ot,n(a.$numberFormat(r.monto)),1),t("td",et,[e(I).includes("eliminar-pagos")?z((c(),C(l,{key:0,class:"w-8 h-8 rounded bg-red-700 border-0 flex justify-center text-center text-base font-normal text-white hover:bg-red-600",onClick:w(lt=>N(r.id),["prevent"])},{default:v(()=>[st]),_:2},1032,["onClick"])),[[P,{value:"Eliminar",pt:{text:"bg-gray-500 p-1 text-xs text-white rounded"}},void 0,{top:!0}]]):D("",!0)])]))),256))])])]),t("div",at,[t("p",null,[rt,y(" "+n(a.$numberFormat(e(o).saldo)),1)])])]),t("div",nt,[x(l,{label:"Cancelar",pt:{root:"mr-5 py-1"},severity:"danger",size:"small",onClick:S,type:"button"}),e(o).saldo>0?(c(),C(l,{key:0,label:"Agregar Pago",size:"small",type:"button",onClick:w(B,["prevent"]),class:L({"opacity-50":e(o).processing}),disabled:e(o).processing},null,8,["onClick","class","disabled"])):D("",!0)])])]),_:1},8,["visible","header"])])}}};export{Ft as default};
