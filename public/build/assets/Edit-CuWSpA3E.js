import{r as b,o as F,R as k,S as et,f as n,g as d,W as l,E as e,Y as w,j as s,C as z,D as c,y as M,u as _,T as x,x as ot,a5 as v,a4 as st,F as I,A as P,z as at,ad as lt,ae as rt}from"./@vue-BLfC86mR.js";import{_ as it}from"./AppLayout-BWpqwQoE.js";import{K as g,T as nt,Z as dt,O as R}from"./@inertiajs-CMyvZJ1U.js";import{aH as ct,h as U}from"./primevue-DAb-R_om.js";import{_ as u}from"./InputError-DdpGOVhM.js";import{_ as i}from"./InputLabel-CkCrW4zf.js";import{s as ut}from"./@vueform-CFisUGo2.js";import{a as pt}from"./axios-ngrFHoWO.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./pusher-js-Ck_2Ecjm.js";import"./logo-C8Jea0Rc.js";import"./pinia-IH2nVPr3.js";import"./@vueuse-BEDuuF1-.js";import"./sweetalert2-5zhdP7Ax.js";import"./@headlessui-CeD_lX9I.js";import"./@heroicons-CatyAbtO.js";import"./loader-D-Kjbgh8.js";import"./deepmerge-Bh_OW9zV.js";import"./qs-ErqSC6LE.js";import"./side-channel-QUUGuE8A.js";import"./get-intrinsic-Dq22P_nh.js";import"./es-object-atoms-BR76m4z7.js";import"./es-errors-DjMuYndc.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-B8JEaMPD.js";import"./dunder-proto-DWby8p2a.js";import"./call-bind-apply-helpers-CZLbXZmW.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bind-BmU8hBQf.js";import"./object-inspect-ronoqz_t.js";import"./nprogress-Di1940OM.js";import"./lodash.clonedeep-D_Ud3gdH.js";import"./lodash.isequal-BY8B19Vp.js";const D=h=>(lt("data-v-362a633e"),h=h(),rt(),h),gt={class:"card px-4 mb-4 bg-white col-span-12 py-5 rounded-lg shadow-lg 2xl:col-span-12 dark:border-gray-700 dark:bg-gray-800"},ft={class:"align-middle"},xt=["onSubmit"],bt={class:"px-2 pt-4 pb-0 grid grid-cols-12 gap-4 mb-2"},_t={class:"col-span-12 shadow-default xl:col-span-3"},vt={class:"col-span-12 shadow-default xl:col-span-5"},ht={class:"col-span-12 shadow-default xl:col-span-4"},yt={class:"col-span-12 shadow-default xl:col-span-3"},kt={class:"col-span-12 shadow-default xl:col-span-3"},wt={class:"col-span-12 shadow-default xl:col-span-3"},Vt={class:"col-span-12 shadow-default xl:col-span-3"},Ct={key:0,class:"col-span-12 shadow-default xl:col-span-3"},At={class:"font-normal text-gray-800 text-base"},St={key:1,class:"col-span-12 shadow-default xl:col-span-3"},It={key:2,class:"col-span-12 shadow-default xl:col-span-3"},Ut={class:"font-normal text-gray-800 text-base"},Tt={key:3,class:"col-span-12 shadow-default xl:col-span-3"},Dt={class:"col-span-12 shadow-default xl:col-span-6"},Et=D(()=>s("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-300",id:"imagen"},"Peso máximo de la foto 2MB",-1)),jt={class:"col-span-12 shadow-default xl:col-span-3"},Ft=D(()=>s("div",{class:"col-span-12 w-full flex flex-col md:flex-row pt-2"},[s("div",{class:"bg-gray-200 w-full text-start"},[s("h3",{class:"font-semibold text-gray-800 text-lg px-5"},"ATRIBUTOS: ")])],-1)),zt={class:"col-span-12 w-full flex flex-col md:flex-row pt-2"},Mt={class:"flex justify-start col-span-12 w-full flex-col md:flex-row py-1 px-5"},Pt={class:"w-full md:w-1/3 xl:w-1/3 mr-2"},Rt={class:"font-semibold text-gray-800 text-base"},$t={class:"w-56"},Bt={class:"font-normal text-gray-800 text-base"},Nt={class:"rounded-md p-1 flex justify-center items-center bg-red-600 py-auto text-base font-semibold text-white hover:bg-red-700"},Ot=["onClick"],qt=D(()=>s("i",{class:"fas fa-trash"},null,-1)),Lt=[qt],Kt={class:"flex justify-end pt-2"},Wt={class:"card flex justify-content-center"},Gt={class:"flex flex-wrap gap-3 w-full"},Ht={class:"col-span-6 shadow-default xl:col-span-3"},Yt={key:0,class:"flex align-items-center"},Zt={key:1},Jt={class:"flex align-items-center"},T="Editar Producto",V="productos",Qt="atributos",Xt={__name:"Edit",setup(h){const C=b("/images/productos/sin_foto.png"),$=ct(),{permissions:y}=g().props.auth,{atributos:B}=g().props,{lista_atributos:N}=g().props,A=b(!1),O=b([]),S=b([]),t=nt({id:"",origen:"",nombre:"",aduana:"",codigo_barra:"",stock:0,precio:0,stock_minimo:0,imagen:"",photo:"",costo_origen:null,costo_fecha:null,costo_real:0,costo_id:null,categorias:[],atributos:[]});F(()=>{H(g().props.producto.id),E.value.options=g().props.lista_categorias;var a=g().props.producto;t.id=a.id,t.nombre=a.nombre,t.origen=a.origen,t.aduana=a.aduana,t.codigo_barra=a.codigo_barra,t.precio=a.precio,t.stock=a.stock,t.stock_minimo=a.stock_minimo,t.stock_futuro=a.stock_futuro,t.costo_real=a.costos_reales.length>0?a.costos_reales[0].monto:0,t.costo_origen=a.costos_reales.length>0?a.costos_reales[0].origen:null,t.costo_id=a.costos_reales.length>0?a.costos_reales[0].id:null,t.costo_fecha=a.costos_reales.length>0?a.costos_reales[0].fecha:null,t.atributos=B,a.categorias.length>0&&a.categorias.forEach(o=>{t.categorias.push(o.id)}),C.value=a.imagen,t.imagen=a.imagen});const q=()=>{t.clearErrors(),t.post(route(V+".update",t.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{K("success","Mensaje","Producto Actualizado"),setTimeout(()=>{R.get(route(V+".show",t.id))},1e3)},onFinish:()=>{},onError:()=>{}})},E=b({value:"",closeOnSelect:!0,placeholder:"Categorías",mode:"tags",searchable:!0,options:[]}),L=a=>{a.target.value.length>0&&(t.stock_futuro=parseFloat(t.stock_futuro)+parseFloat(a.target.value))},K=(a,o,p)=>{$.add({severity:a,summary:o,detail:p,life:3e3})},W=()=>{R.get(route(V+".index"))},G=a=>{a.preventDefault(),t.photo=a.target.files[0];let o=a.target.files;if(o&&o[0]){let p=new FileReader;p.onload=f=>{C.value=f.target.result},p.readAsDataURL(o[0])}},H=a=>{pt.get(route(Qt+".listado-producto",a)).then(o=>{console.log("r2 ",o.data),O.value=o.data.listado}).finally(()=>{})},Y=a=>{console.log("e ",a.value.id),console.log("lista_atributos ",S.value.atributos);var o=S.value.find(p=>p.id===a.value.id);console.log("e2 ",o.id),t.atributos.push({id:o.id,valor:o.valor,nombre:o.nombre,atributo_id:o.atributo_id,producto_id:o.producto_id})},Z=a=>{t.atributos.splice(a,1)},J=()=>{A.value=!0};return F(()=>{S.value=g().props.lista_atributos.data}),(a,o)=>{const p=k("Toast"),f=k("InputText"),Q=k("Dropdown"),X=k("Dialog"),tt=et("tooltip");return d(),n(I,null,[l(e(dt),{title:T}),l(it,{pagina:[{label:"Productos",link:!0,url:a.route(V+".index")},{label:T,link:!1}]},{default:w(()=>[s("div",gt,[l(p),s("div",{class:"px-3 col-span-full flex justify-between items-center"},[s("h5",{class:"text-2xl font-medium"},c(T))]),z(" "+c(e(t))+" ",1),s("div",ft,[s("form",{onSubmit:M(q,["prevent"])},[s("div",bt,[s("div",_t,[l(i,{for:"origen",value:"Origen",class:"block text-base font-medium leading-6 text-gray-900"}),l(f,{type:"text",id:"origen",modelValue:e(t).origen,"onUpdate:modelValue":o[0]||(o[0]=r=>e(t).origen=r),placeholder:"Ingrese origen",pt:{root:{class:"h-9 w-full"}}},null,8,["modelValue"]),l(u,{class:"mt-1 text-xs",message:e(t).errors.origen},null,8,["message"])]),s("div",vt,[l(i,{for:"nombre",value:"Nombre",class:"block text-base font-medium leading-6 text-gray-900"}),l(f,{type:"text",id:"nombre",modelValue:e(t).nombre,"onUpdate:modelValue":o[1]||(o[1]=r=>e(t).nombre=r),placeholder:"Ingrese nombre",pt:{root:{class:"h-9 w-full"}}},null,8,["modelValue"]),l(u,{class:"mt-1 text-xs",message:e(t).errors.nombre},null,8,["message"])]),s("div",ht,[l(i,{for:"categorias",value:"Categoría",class:"block text-base font-medium leading-6 text-gray-900"}),l(e(ut),ot({id:"categorias",modelValue:e(t).categorias,"onUpdate:modelValue":o[2]||(o[2]=r=>e(t).categorias=r),class:"w-full"},E.value),null,16,["modelValue"])]),s("div",yt,[l(i,{for:"aduana",value:"Aduana",class:"block text-base font-medium leading-6 text-gray-900"}),l(f,{type:"text",id:"aduana",modelValue:e(t).aduana,"onUpdate:modelValue":o[3]||(o[3]=r=>e(t).aduana=r),placeholder:"Ingrese aduana",pt:{root:{class:"h-9 w-full"}}},null,8,["modelValue"]),l(u,{class:"mt-1 text-xs",message:e(t).errors.aduana},null,8,["message"])]),s("div",kt,[l(i,{for:"codigo_barra",value:"Código barra",class:"block text-base font-medium leading-6 text-gray-900"}),l(f,{type:"text",id:"codigo_barra",modelValue:e(t).codigo_barra,"onUpdate:modelValue":o[4]||(o[4]=r=>e(t).codigo_barra=r),placeholder:"Ingrese Código barra",pt:{root:{class:"h-9 w-full"}}},null,8,["modelValue"]),l(u,{class:"mt-1 text-xs",message:e(t).errors.codigo_barra},null,8,["message"])]),s("div",wt,[l(i,{for:"stock",value:"Stock",class:"block text-base font-medium leading-6 text-gray-900"}),x(s("input",{type:"number",required:"","onUpdate:modelValue":o[5]||(o[5]=r=>e(t).stock=r),step:"1",min:"0",onKeyup:o[6]||(o[6]=r=>L(r)),class:"p-inputtext text-end p-component h-9 w-full font-sans font-normal text-gray-700 dark:text-white/80 bg-white dark:bg-gray-900 border border-gray-300 dark:border-blue-900/40 transition-colors duration-200 appearance-none rounded-md text-sm px-2 py-1"},null,544),[[v,e(t).stock]]),l(u,{class:"mt-1 text-xs",message:e(t).errors.stock},null,8,["message"])]),s("div",Vt,[l(i,{for:"stock_minimo",value:"Stock Minimo",class:"block text-base font-medium leading-6 text-gray-900"}),x(s("input",{type:"number",required:"","onUpdate:modelValue":o[7]||(o[7]=r=>e(t).stock_minimo=r),step:"1",min:"0",class:"p-inputtext text-end p-component h-9 w-full font-sans font-normal text-gray-700 dark:text-white/80 bg-white dark:bg-gray-900 border border-gray-300 dark:border-blue-900/40 transition-colors duration-200 appearance-none rounded-md text-sm px-2 py-1"},null,512),[[v,e(t).stock_minimo]]),l(u,{class:"mt-1 text-xs",message:e(t).errors.stock_minimo},null,8,["message"])]),e(y).includes("productos-editar_precio")==!1?(d(),n("div",Ct,[l(i,{for:"costo_real",value:"Precio",class:"block text-base font-medium leading-6 text-gray-900"}),s("h3",At,c(e(t).precio),1)])):_("",!0),e(y).includes("productos-editar_precio")?(d(),n("div",St,[l(i,{for:"costo_real",value:"Precio",class:"block text-base font-medium leading-6 text-gray-900"}),x(s("input",{type:"number",required:"","onUpdate:modelValue":o[8]||(o[8]=r=>e(t).precio=r),step:"0.02",min:"0",class:"p-inputtext text-end p-component h-9 w-full font-sans font-normal text-gray-700 dark:text-white/80 bg-white dark:bg-gray-900 border border-gray-300 dark:border-blue-900/40 transition-colors duration-200 appearance-none rounded-md text-sm px-2 py-1"},null,512),[[v,e(t).precio]]),l(u,{class:"mt-1 text-xs",message:e(t).errors.precio},null,8,["message"])])):_("",!0),e(y).includes("productos-costoreal")==!1?(d(),n("div",It,[l(i,{for:"costo_real",value:"Costo Real",class:"block text-base font-medium leading-6 text-gray-900"}),s("h3",Ut,c(e(t).costo_real),1)])):_("",!0),e(y).includes("productos-costoreal")?(d(),n("div",Tt,[l(i,{for:"costo_real",value:"Costo Real",class:"block text-base font-medium leading-6 text-gray-900"}),x(s("input",{type:"number",required:"","onUpdate:modelValue":o[9]||(o[9]=r=>e(t).costo_real=r),step:"0.02",min:"0",class:"p-inputtext text-end p-component h-9 w-full font-sans font-normal text-gray-700 dark:text-white/80 bg-white dark:bg-gray-900 border border-gray-300 dark:border-blue-900/40 transition-colors duration-200 appearance-none rounded-md text-sm px-2 py-1"},null,512),[[v,e(t).costo_real]]),l(u,{class:"mt-1 text-xs",message:e(t).errors.costo_real},null,8,["message"])])):_("",!0),x(s("input",{type:"hidden",id:"stock_futuro","onUpdate:modelValue":o[10]||(o[10]=r=>e(t).stock_futuro=r)},null,512),[[v,e(t).stock_futuro]]),s("div",Dt,[l(i,{for:"file_input1",value:"Imagen",class:"block text-base font-medium leading-6 text-gray-900"}),s("input",{onInput:G,type:"file",class:"block w-full text-xs text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-medium file:bg-gray-200 file:text-gray-700 hover:file:bg-gray-300 hover:file:cursor-pointer",accept:"image/x-png,image/gif,image/jpeg"},null,32),Et,l(u,{class:"mt-1 text-xs",message:e(t).errors.imagen},null,8,["message"])]),s("div",jt,[s("div",{class:"imagePreviewWrapper",style:st({"background-image":`url(${C.value})`})},null,4)]),Ft,s("div",zt,[l(e(U),{size:"small",onClick:J,type:"button",label:"Agregar Atributo",severity:"success"})]),e(t).atributos.length>0?(d(!0),n(I,{key:4},P(e(t).atributos,(r,j)=>(d(),n("div",Mt,[s("div",Pt,[s("h3",Rt,c(r.nombre)+": ",1)]),s("div",$t,[s("h3",Bt,c(r.valor),1)]),s("div",Nt,[x((d(),n("button",{type:"button",onClick:M(m=>Z(j),["prevent"]),class:"w-6"},Lt,8,Ot)),[[tt,{value:"Eliminar",pt:{text:"bg-gray-500 p-1 m-0 text-xs text-white rounded"}},void 0,{top:!0}]])])]))),256)):_("",!0)]),s("div",Kt,[l(e(U),{label:"Cancelar",pt:{root:"mr-5 py-1"},severity:"danger",size:"small",onClick:W,type:"button"}),l(e(U),{label:"Guardar",size:"small",type:"submit",class:at({"opacity-50":e(t).processing}),disabled:e(t).processing},null,8,["class","disabled"])])],40,xt)])]),l(X,{visible:A.value,"onUpdate:visible":o[12]||(o[12]=r=>A.value=r),modal:"",header:"Atributos",style:{width:"30vw"},breakpoints:{"1199px":"75vw","575px":"90vw"},position:"top",pt:{header:{class:"mt-6 p-2 lg:p-4 "},content:{class:"p-4 lg:p-4"}}},{default:w(()=>[s("div",Wt,[(d(!0),n(I,null,P(e(N).data,(r,j)=>(d(),n("div",Gt,[s("div",Ht,[l(i,{for:"rol",value:r.nombre,class:"block text-base font-normal leading-6 text-gray-900"},null,8,["value"]),z(" "+c(e(t).atributos)+" ",1),l(Q,{options:r.valores,onChange:o[11]||(o[11]=m=>Y(m)),"v-model":e(t).atributos,optionLabel:"valor",placeholder:"Select a Country",class:"w-full md:w-14rem"},{value:w(m=>[m.option?(d(),n("div",Yt,[s("div",null,c(m.option.id),1)])):(d(),n("span",Zt,c(m.placeholder),1))]),option:w(m=>[s("div",Jt,[s("div",null,c(m.option.valor),1)])]),_:2},1032,["options","v-model"])])]))),256))])]),_:1},8,["visible"])]),_:1},8,["pagina"])],64)}}},Pe=mt(Xt,[["__scopeId","data-v-362a633e"]]);export{Pe as default};
