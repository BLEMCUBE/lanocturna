import{r as m,o as _e,M as S,N as xe,e as i,f as n,Q as r,ab as a,S as _,i as e,l as q,p as V,q as G,y as c,F as x,u as h,O as Q,a0 as fe,P as be,j as f,x as D}from"./@vue-BG0wrCoO.js";import{_ as he}from"./AppLayout-DGXGhT07.js";import{K as z,T as Z,Z as ve,O as $}from"./@inertiajs-BPLxF6VH.js";import{aH as ge,aI as ye,h as v}from"./primevue-DlS7f910.js";import{_ as b}from"./InputError-cOM6HFrc.js";import{_ as g}from"./InputLabel-BIVuqiPx.js";import{s as J}from"./@vueform-CSVNwuWD.js";import{S as we}from"./sweetalert2-DhUVDY3P.js";import"./logo-C8Jea0Rc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./loader-DTMt_fBO.js";import"./pinia-f5v7c1ZR.js";import"./laravel-echo-CPaRdDZ5.js";import"./pusher-js-CipxKyPu.js";import"./axios-ngrFHoWO.js";import"./deepmerge-CejY7WQD.js";import"./qs-DSMFT7gQ.js";import"./side-channel-C2E4DO94.js";import"./get-intrinsic-Dq22P_nh.js";import"./es-object-atoms-BR76m4z7.js";import"./es-errors-DjMuYndc.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-B8JEaMPD.js";import"./dunder-proto-DWby8p2a.js";import"./call-bind-apply-helpers-CZLbXZmW.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bind-BmU8hBQf.js";import"./object-inspect-sCGRVelf.js";import"./nprogress-D6y_-DtI.js";import"./lodash.clonedeep-DcClQ2Wp.js";import"./lodash.isequal-qgBWtdDc.js";const ke={class:"col-span-12 md:col-span-6 shadow-default lg:col-span-6 mx-2"},Ce=["disabled"],Fe={class:"col-span-12 md:col-span-6 mx-2 py-0 shadow-default xl:col-span-3 w-full"},Se={class:"col-span-12 shadow-default xl:col-span-3 flex h-auto items-end justify-center pb-1"},Ve={class:"h-10"},De={class:"col-span-12 xl:col-span-3 flex h-auto items-end justify-start px-1"},Ne={class:"h-8"},Ee={class:"grid grid-cols-12 p-0 m-0 gap-2 mb-4 bg-white col-span-12 py-2 rounded-lg shadow-lg lg:col-span-12 dark:border-gray-700 dark:bg-gray-800"},Te={class:"mt-0 mb-4 col-span-12 lg:col-span-8"},Ie={class:"grid grid-cols-12 gap-1 py-0"},Me={class:"table-auto mx-2 border border-gray-300 col-span-12"},je=e("thead",null,[e("tr",{class:"p-2 bg-secondary-900 border"},[e("th",{class:"border border-gray-300 p-2 w-24"},"Origen"),e("th",{class:"border border-gray-300"},"Producto"),e("th",{class:"border border-gray-300 w-24"},"Cantidad"),e("th",{class:"border border-gray-300 w-8"})])],-1),Ue={class:"border border-gray-300 p-2"},Oe={class:"border border-gray-300 p-2"},ze={class:"border border-gray-300"},$e=["onUpdate:modelValue","onInput"],Ae={class:"border-none border-gray-300 p-1"},Le={class:"rounded-md p-1 flex justify-center items-center bg-red-600 py-auto text-base font-semibold text-white hover:bg-red-700"},Pe=["onClick"],Be=e("i",{class:"fas fa-trash"},null,-1),He=[Be],Ke={class:"col-span-12 p-2 xl:col-span-12"},Re=e("div",{class:"px-0 py-1 m-2 bg-primary-900 text-white col-span-full flex justify-center items-center"},[e("h5",{class:"text-lg font-medium"},"Datos venta")],-1),qe={class:"col-span-12 mx-2 py-0 shadow-default xl:col-span-6"},Ge={class:"col-span-12 mx-2 py-0 shadow-default xl:col-span-6"},Qe={class:"col-span-12 mx-2 py-0 shadow-default xl:col-span-6"},Ze={class:"flex justify-end py-3"},Je={class:"p-0 mb-0 col-span-12 lg:col-span-4 px-2"},We={class:"flex justify-content-end text-sm"},Xe={class:"w-full my-0"},Ye={class:"bg-white border-2 overflow-hidden"},et={class:"py-2 px-2"},tt={class:"flex items-center space-x-3"},ot={class:"flex-shrink-0"},st=["src"],lt={class:"flex-1 min-w-0 text-start py-1"},at={class:"text-xs md:text-[14px] font-medium whitespace-pre-line leading-4 text-gray-900"},rt={class:"font-bold leading-4 text-xs text-gray-800 py-1"},nt={class:"px-1 py-0 font-normal"},it={class:"font-bold leading-4 text-xs text-gray-800 py-1"},ct={class:"px-1 py-0 font-normal text-xs"},dt={key:0,class:"leading-none mt-1 text-xs text-gray-800"},pt={class:"list-disc list-outside"},ut={key:0,class:"list-none"},mt=e("b",{class:"text-xs leading-2 mt-1 text-gray-700 dark:text-gray-300"}," Próximo Ingreso: ",-1),_t=[mt],xt={key:1,class:"list-none pt-1 text-[14px] md:text-[11px]"},ft=e("b",{class:"text-[14px] md:text-[12px]"}," Importación | Cant. | Fecha ",-1),bt=[ft],ht={key:2,class:"ml-1 mt-1.5 list-none"},vt={class:"text-[14px] md:text-[12px]"},gt={class:"inline-flex items-center text-base font-semibold text-gray-900 dark:text-white pr-2"},yt=["onClick","disabled"],wt=e("i",{class:"fas fa-cart-plus"},null,-1),kt=[wt],Ct={key:0},Ft=e("p",{class:"mb-2 font-semibold text-md"}," Los siguientes productos no estan registrado , por favor registre y vuelva a intentar. ",-1),St={class:"w-full border"},Vt=e("thead",null,[e("tr",{class:"w-full border"},[e("th",{class:"w-26 text-center border"}," Fila "),e("th",{class:"text-center border"}," Sku ")])],-1),Dt={class:"w-full text-center border"},Nt={class:"text-center border"},Et={class:"text-center border"},Tt={key:1},It=e("p",{class:"mb-2 mt-4 font-semibold text-md"}," Las siguientes compras ya existen en el sistema, por favor corriga e intente nuevamente. ",-1),Mt={class:"w-full border"},jt=e("thead",null,[e("tr",{class:"w-full border"},[e("th",{class:"w-26 text-center border"}," Fila "),e("th",{class:"text-center border"}," Número Compra ")])],-1),Ut={class:"w-full text-center border"},Ot={class:"text-center border"},zt={class:"text-center border"},$t={key:2},At=e("p",{class:"mb-2 mt-4 font-semibold text-md"}," Los siguientes productos no disponen de stock. ",-1),Lt={class:"w-full border"},Pt=e("thead",null,[e("tr",{class:"w-full border"},[e("th",{class:"w-26 text-center border font-semibold"}," Fila "),e("th",{class:"text-center border font-semibold"}," SKU "),e("th",{class:"text-center border font-semibold"}," Stock en Sistema ")])],-1),Bt={class:"w-full text-center border"},Ht={class:"text-center border"},Kt={class:"text-center border"},Rt={class:"text-center border"},qt=e("div",{class:"flex flex-column align-items-center",style:{flex:"1"}},[e("div",{class:"text-center"},[e("i",{class:"pi pi-exclamation-triangle text-yellow-500",style:{"font-size":"3rem"}})]),e("div",{class:"font-semibold text-xl m-3"},"No se ha podido importar")],-1),Gt={class:"flex justify-end py-3"},Qt={class:"mb-2 mt-0 font-semibold text-center text-md"},Zt=e("div",{class:"flex flex-column align-items-center",style:{flex:"1"}},[e("div",{class:"text-center"},[e("i",{class:"pi pi-exclamation-triangle text-yellow-500",style:{"font-size":"3rem"}})]),e("div",{class:"font-semibold text-xl m-3"},"No se ha podido importar")],-1),Jt={class:"flex justify-end py-3"},A="Mercado Libre",N="envios",jo={__name:"Create",setup(Wt){const W=ge(),y=m(!1),w=m(!1),E=m(!1),T=m(),I=m(),L=m(),M=m(),k=m(null),{tipo_cambio:X}=z().props,{lista_destinos:P}=z().props,d=Z({destino:"",archivo:""}),j=m({global:{value:null,matchMode:ye.CONTAINS}}),Y=l=>{P.find(t=>t.value===l),o.destino=l},ee=l=>{d.destino=l},o=Z({vendedor_id:"",destino:"",total:0,total_sin_iva:0,moneda:"Pesos",tipo:"ENVIO",nro_compra:"",tipo_cambio:"",estado:"FACTURADO",observaciones:"",productos:[],cliente:{nombre:"",direccion:""}}),{productos:B}=z().props,U=m({value:"",closeOnSelect:!0,placeholder:"Seleccione",searchable:!1,options:[]});m({value:"Pesos",closeOnSelect:!0,placeholder:"Seleccione",searchable:!1,options:[{value:"Pesos",label:"Pesos"},{value:"Dólares",label:"Dólares"}]}),_e(()=>{U.value.options=P,o.tipo_cambio=X,o.moneda="Pesos"});const te=l=>{o.clearErrors();var t=B.data.find(u=>u.id===l);t.stock>0?(o.productos.push({producto_id:t.id,nombre:t.nombre,origen:t.origen,cantidad:1,precio:null,stock:t.stock,total:1}),O(),C()):H("No hay stock disponible","error")},O=()=>{o.total=o.productos.reduce((l,t)=>l+parseFloat(t.total),0).toFixed(2),o.total_sin_iva=o.productos.reduce((l,t)=>l+parseFloat(t.total_sin_iva),0).toFixed(2),C()},oe=l=>{o.productos.splice(l,1),O(),C()},C=()=>{o.total_sin_iva=(o.total/1.22).toFixed(2)},se=(l,t)=>{var u=o.productos[t].precio===null?1:o.productos[t].precio;if(l.target.value>0)o.productos[t].stock>=o.productos[t].cantidad?(o.productos[t].total=parseFloat(o.productos[t].cantidad)*parseFloat(u).toFixed(2),o.productos[t].total_sin_iva=parseFloat(o.productos[t].cantidad)*parseFloat(u/1.22).toFixed(2),o.productos[t].precio_sin_iva=(o.productos[t].precio/1.22).toFixed(2),O(),C()):(o.productos[t].cantidad=1,o.productos[t].precio_sin_iva=o.productos[t].precio/1.22,o.productos[t].total=parseFloat(o.productos[t].cantidad)*parseFloat(u).toFixed(2),H("La cantidad supera el Stock","error"));else return},le=()=>{o.clearErrors(),o.post(route(N+".store"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{K("success","Mensaje","Envio creado"),setTimeout(()=>{$.get(route(N+".create"))},1e3)},onFinish:()=>{},onError:()=>{}})},H=(l,t)=>{we.fire({width:350,title:l,icon:t})},K=(l,t,u)=>{W.add({severity:l,summary:t,detail:u,life:3e3})},ae=()=>{$.get(route("inicio"))},re=l=>{l.preventDefault(),d.archivo=l.target.files[0]},ne=l=>{if(l.length>0)window.open(route("plantillas.importar",l),"_blank");else return},ie=()=>{E.value=!0,d.clearErrors(),d.post(route(N+".uploadexcel"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{E.value=!1,K("success","Mensaje","Excel Importado"),setTimeout(()=>{$.get(route(N+".create"))},1e3)},onFinish:()=>{},onError:l=>{E.value=!1,k.value.value=null,d.reset("archivo"),l.filas!=null||l.compras!=null||l.stock!=null?(l.stock.length>0||l.compras.length>0||l.filas.length>0)&&(T.value=l.filas,I.value=l.compras,M.value=l.stock,y.value=!0):l.error_compra!=null&&l.error_compra.length>0&&(L.value=l.error_compra,w.value=!0)}})},ce=()=>{k.value.value=null,d.reset("archivo"),y.value=!1},de=()=>{k.value.value=null,d.reset("archivo"),w.value=!1};return(l,t)=>{const u=S("InputText"),pe=S("Column"),ue=S("DataTable"),R=S("Dialog"),me=xe("tooltip");return n(),i(x,null,[r(a(ve),{title:A}),r(he,{pagina:[{label:A,link:!1}]},{default:_(()=>[e("div",ke,[r(g,{for:"file_input1",value:"Importar Excel",class:"block text-base font-medium leading-6 text-gray-900"}),e("input",{ref_key:"inputArchivo",ref:k,onInput:re,type:"file",class:"block w-full text-xs text-gray-500 file:mr-4 file:py-1.5 file:px-3 file:rounded file:border-0 file:text-sm file:font-medium file:bg-primary-900 file:text-white hover:file:bg-primary-900/80 hover:file:cursor-pointer file:disabled::opacity-75 file:disabled:cursor-no-drop disabled:opacity-75 disabled:cursor-no-drop",disabled:a(d).processing,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},null,40,Ce),r(b,{class:"mt-1 text-xs",message:a(d).errors.archivo},null,8,["message"])]),e("div",Fe,[r(g,{for:"destino1",value:"Destino",class:"text-base font-medium leading-1 text-gray-900"}),r(a(J),q({id:"destino1",disabled:a(d).processing,modelValue:a(d).destino,"onUpdate:modelValue":t[0]||(t[0]=s=>a(d).destino=s)},U.value,{onSelect:ee}),null,16,["disabled","modelValue"]),r(b,{class:"mt-1 text-xs",message:a(d).errors.destino},null,8,["message"])]),e("div",Se,[e("div",Ve,[r(a(v),{label:"Importar",type:"button",class:G(["text-normal",{"opacity-50":a(o).processing}]),disabled:a(d).processing,onClick:V(ie,["prevent"])},null,8,["class","disabled","onClick"])])]),e("div",De,[e("div",Ne,[r(a(v),{label:"Descargar formato",size:"md",severity:"success",type:"button",class:"p-1 text-xs font-light ring-0",onClick:t[1]||(t[1]=s=>ne("formato_importar_mercadolibre.xlsx"))})])]),e("div",Ee,[e("div",Te,[e("div",{class:"px-0 py-1 m-2 mt-0 bg-primary-900 text-white col-span-full flex justify-center items-center"},[e("h5",{class:"text-2xl font-medium"},c(A))]),e("form",null,[e("div",Ie,[e("table",Me,[je,e("tbody",null,[(n(!0),i(x,null,h(a(o).productos,(s,p)=>(n(),i("tr",{key:p,class:"font-sans font-normal text-gray-800 border border-gray-300"},[e("td",Ue,c(s.origen),1),e("td",Oe,c(s.nombre),1),e("td",ze,[Q(e("input",{type:"number","onUpdate:modelValue":F=>s.cantidad=F,min:"1",step:"1",class:"p-inputtext p-component font-sans font-normal text-gray-700 bg-white border-0 appearance-none rounded-none text-sm px-2 py-0 p-inputnumber-input h-9 m-0 w-full text-end",onInput:V(F=>se(F,p),["prevent"])},null,40,$e),[[fe,s.cantidad]])]),e("td",Ae,[e("div",Le,[Q((n(),i("button",{type:"button",onClick:V(F=>oe(p),["prevent"]),class:"w-6"},He,8,Pe)),[[me,{value:"Eliminar",pt:{text:"bg-gray-500 p-1 m-0 text-xs text-white rounded"}},void 0,{top:!0}]])])])]))),128))])]),e("div",Ke,[r(b,{class:"mt-1 text-lg w-full",message:a(o).errors.productos},null,8,["message"]),(n(!0),i(x,null,h(a(o).errors.campos_productos,s=>(n(),be(b,{class:"mt-1 mb-0 text-lg",message:s},null,8,["message"]))),256))]),Re,e("div",qe,[r(g,{for:"nro_compra",value:"Nro Compra",class:"text-base font-medium leading-6 text-gray-900"}),r(u,{type:"text",id:"nro_compra",modelValue:a(o).nro_compra,"onUpdate:modelValue":t[2]||(t[2]=s=>a(o).nro_compra=s),placeholder:"ingrese nro compra",pt:{root:{class:"h-9 w-full"}}},null,8,["modelValue"]),r(b,{class:"mt-1 text-xs",message:a(o).errors.nro_compra},null,8,["message"])]),e("div",Ge,[r(g,{for:"destino",value:"Destino",class:"text-base font-medium leading-1 text-gray-900"}),r(a(J),q({id:"rol",modelValue:a(o).destino,"onUpdate:modelValue":t[3]||(t[3]=s=>a(o).destino=s)},U.value,{onSelect:Y}),null,16,["modelValue"]),r(b,{class:"mt-1 text-xs",message:a(o).errors.destino},null,8,["message"])]),e("div",Qe,[r(g,{for:"cliente",value:"Cliente",class:"text-base font-medium leading-6 text-gray-900"}),r(u,{type:"text",id:"cliente",modelValue:a(o).cliente.nombre,"onUpdate:modelValue":t[4]||(t[4]=s=>a(o).cliente.nombre=s),placeholder:"ingrese nombre cliente",pt:{root:{class:"h-9 w-full"}}},null,8,["modelValue"]),r(b,{class:"mt-1 text-xs",message:a(o).errors["cliente.nombre"]},null,8,["message"])])]),e("div",Ze,[r(a(v),{label:"Cancelar",pt:{root:"mr-5 py-1"},severity:"danger",size:"small",onClick:ae,type:"button"}),r(a(v),{label:"Guardar",size:"small",type:"button",class:G({"opacity-50":a(o).processing}),disabled:a(o).processing,onClick:V(le,["prevent"])},null,8,["class","disabled","onClick"])])])]),e("div",Je,[r(ue,{filters:j.value,scrollable:"",scrollHeight:"550px",globalFilterFields:["origen","nombre"],value:a(B).data,virtualScrollerOptions:{itemSize:46,lazy:"true",numToleratedItems:20}},{header:_(()=>[e("div",We,[r(u,{class:"w-full mx-1",modelValue:j.value.global.value,"onUpdate:modelValue":t[5]||(t[5]=s=>j.value.global.value=s),placeholder:"Buscar"},null,8,["modelValue"])])]),empty:_(()=>[D(" No existe Resultado ")]),loading:_(()=>[D(" Cargando... ")]),default:_(()=>[r(pe,{field:"nombre",header:"Productos",pt:{bodyCell:{class:"flex justify-start text-center p-0 mx-0"}}},{body:_(s=>[e("div",Xe,[e("div",Ye,[e("ul",null,[e("li",et,[e("div",tt,[e("div",ot,[e("img",{class:"w-12 h-12 rounded-full",src:s.data.imagen,alt:""},null,8,st)]),e("div",lt,[e("div",at,c(s.data.nombre),1),e("div",rt,[D(" Origen: "),e("span",nt,c(s.data.origen),1)]),e("div",it,[D(" Stock: "),e("span",ct,c(s.data.stock),1)]),s.data.importacion_detalles.length>0?(n(),i("div",dt,[e("ul",pt,[(n(!0),i(x,null,h(s.data.importacion_detalles,p=>(n(),i(x,null,[p.importacion.estado=="En camino"?(n(),i("li",ut,_t)):f("",!0),p.importacion.estado=="En camino"?(n(),i("li",xt,bt)):f("",!0),p.importacion.estado=="En camino"?(n(),i("li",ht,[e("p",vt,c(p.importacion.nro_carpeta)+" | "+c(p.cantidad_total)+" | "+c(p.importacion.fecha_arribado),1)])):f("",!0)],64))),256))])])):f("",!0)]),e("div",gt,[e("button",{onClick:p=>te(s.data.id),class:"bg-green-500 disabled:bg-green-400 disabled:text-gray-500 hover:bg-green-600 text-white rounded px-2 py-1.5",disabled:a(o).productos.filter(p=>p.producto_id===s.data.id).length>0},kt,8,yt)])])])])])])]),_:1})]),_:1},8,["filters","value"])])]),r(R,{visible:y.value,"onUpdate:visible":t[7]||(t[7]=s=>y.value=s),modal:"",style:{width:"30vw"},pt:{header:{class:"mt-5 pb-2 px-5"},content:{class:"p-4"}}},{header:_(()=>[qt]),default:_(()=>[T.value.length>0?(n(),i("div",Ct,[Ft,e("table",St,[Vt,e("tbody",null,[(n(!0),i(x,null,h(T.value,s=>(n(),i("tr",Dt,[e("td",Nt,c(s.fila),1),e("td",Et,c(s.sku),1)]))),256))])])])):f("",!0),I.value.length>0?(n(),i("div",Tt,[It,e("table",Mt,[jt,e("tbody",null,[(n(!0),i(x,null,h(I.value,s=>(n(),i("tr",Ut,[e("td",Ot,c(s.fila),1),e("td",zt,c(s.nro_compra),1)]))),256))])])])):f("",!0),M.value.length>0?(n(),i("div",$t,[At,e("table",Lt,[Pt,e("tbody",null,[(n(!0),i(x,null,h(M.value,s=>(n(),i("tr",Bt,[e("td",Ht,c(s.fila),1),e("td",Kt,c(s.sku),1),e("td",Rt,c(s.stock),1)]))),256))])])])):f("",!0),e("div",Gt,[r(a(v),{label:"Aceptar",size:"small",type:"button",onClick:t[6]||(t[6]=s=>ce())})])]),_:1},8,["visible"]),r(R,{visible:w.value,"onUpdate:visible":t[9]||(t[9]=s=>w.value=s),modal:"",style:{width:"30vw"},pt:{header:{class:"mt-5 pb-2 px-5"},content:{class:"p-4"}}},{header:_(()=>[Zt]),default:_(()=>[e("div",null,[e("p",Qt,c(L.value),1)]),e("div",Jt,[r(a(v),{label:"Aceptar",size:"small",type:"button",onClick:t[8]||(t[8]=s=>de())})])]),_:1},8,["visible"])]),_:1},8,["pagina"])],64)}}};export{jo as default};
