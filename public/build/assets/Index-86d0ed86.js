import{k as X,l as n,K as B,T as E,h as Y,F as ee,m as b,p as te,f as c,a as s,u as o,w as r,q as M,o as d,Z as se,b as e,z as m,n as oe,e as z,t as _,v as A,d as I,A as u,g as V,s as le,O as g}from"./app-a37e7e4f.js";import{_ as ae,S as re}from"./AppLayout-9f427d66.js";import{_ as ie}from"./InputError-d3945a0e.js";import{_ as ne}from"./InputLabel-424933fc.js";import"./logo-e22dfca4.js";import"./_plugin-vue_export-helper-c27b6911.js";const ce={class:"col-span-12 sm:col-span-12 md:col-span-6 shadow-default lg:col-span-5 2xl:col-span-4 mx-2"},de=["disabled"],ue={class:"col-span-12 sm:col-span-12 shadow-default xl:col-span-3 2xl:col-span-2 flex h-auto items-end justify-center pb-1"},pe={class:"h-8"},me={class:"col-span-12 shadow-default xl:col-span-3 flex h-auto items-end 2xl:col-span-2 justify-center pb-1"},fe={class:"h-8"},xe={class:"card px-4 mb-4 bg-white col-span-12 rounded-lg shadow-lg 2xl:col-span-12"},he={class:"px-3 pb-2 col-span-full flex justify-end items-center"},ve={class:"w-8 h-8 rounded bg-green-600 flex justify-center mr-5 items-center text-base font-semibold text-white hover:bg-green-600"},be=["href"],_e=e("i",{class:"fas fa-file-excel text-white"},null,-1),ge=[_e],ye={class:"align-middle"},we={class:"flex justify-content-end text-md"},ke=["src"],Ce=["onClick"],Se=e("i",{class:"fas fa-trash-alt"},null,-1),Fe=[Se],De={key:0},Te=e("p",{class:"mb-2 font-semibold text-md"}," Los siguientes productos no estan registrado , por favor registre y vuelva a intentar. ",-1),Ne={class:"w-full border"},je=e("thead",null,[e("tr",{class:"w-full border"},[e("th",{class:"w-26 text-center border"}," Fila "),e("th",{class:"text-center border"}," Sku ")])],-1),Be={class:"w-full text-center border"},Ee={class:"text-center border"},Me={class:"text-center border"},ze=e("div",{class:"flex flex-column align-items-center",style:{flex:"1"}},[e("div",{class:"text-center"},[e("i",{class:"pi pi-exclamation-triangle text-yellow-500",style:{"font-size":"3rem"}})]),e("div",{class:"font-semibold text-xl m-3"},"No se ha podido importar")],-1),Ae={class:"flex justify-end py-3"},Ie={class:"mb-2 mt-0 font-semibold text-center text-md"},Ve=e("div",{class:"flex flex-column align-items-center",style:{flex:"1"}},[e("div",{class:"text-center"},[e("i",{class:"pi pi-exclamation-triangle text-yellow-500",style:{"font-size":"3rem"}})]),e("div",{class:"font-semibold text-xl m-3"},"No se ha podido importar")],-1),$e={class:"flex justify-end py-3"},S="Productos",p="productos",Ze={__name:"Index",setup(Oe){const $=X(),F=n(),{permissions:O}=B().props.auth,y=n(!1),f=n(null),i=E({archivo:""}),x=n(!1),h=n(!1),w=n(),D=n(),L=E({id:""}),P=t=>{if(parseFloat(t.stock)<=parseFloat(t.stock_minimo)&&parseFloat(t.stock)==parseFloat(t.stock_futuro))return["bg-red-700 text-xs text-white"];if(parseFloat(t.stock)<=parseFloat(t.stock_minimo)&&parseFloat(t.stock_futuro)>parseFloat(t.stock))return"bg-orange-500 text-xs text-white"},R=t=>{g.get(route(p+".show",t))},U=(t,l)=>{re.mixin({buttonsStyling:!0}).fire({width:350,title:"Seguro de eliminar "+l,text:"Se eliminarÃ¡ definitivamente",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",cancelButtonColor:"red",confirmButtonColor:"#2563EB"}).then(C=>{C.isConfirmed&&L.delete(route(p+".destroy",t),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{T("success","Eliminado","Se ha eliminado"),setTimeout(()=>{g.get(route(p+".index"))},1e3)}})})};Y(()=>{F.value=Array.from(B().props.productos.data,t=>t)});const T=(t,l,v)=>{$.add({severity:t,summary:l,detail:v,life:3e3})},q=()=>{g.get(route(p+".create"))},H=t=>{R(t.data.id)},K=t=>{t.preventDefault(),i.archivo=t.target.files[0]},Z=()=>{f.value.value=null,i.reset("archivo"),x.value=!1},G=()=>{f.value.value=null,i.reset("archivo"),h.value=!1},J=t=>{if(t.length>0)window.open(route("plantillas.importar",t),"_blank");else return},Q=()=>{y.value=!0,i.clearErrors(),i.post(route(p+".importarstock"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{y.value=!1,T("success","Mensaje","Stock Importado"),setTimeout(()=>{g.get(route(p+".index"))},1e3)},onFinish:()=>{},onError:t=>{y.value=!1,f.value.value=null,i.reset("archivo"),t.filas!=null?t.filas.length>0&&(w.value=t.filas,x.value=!0):t.error_sku!=null&&t.error_sku.length>0&&(D.value=t.error_sku,h.value=!0)}})},k=n({global:{value:null,matchMode:ee.CONTAINS}});return(t,l)=>{const v=b("Toast"),C=b("InputText"),W=b("DataTable"),N=b("Dialog"),j=te("tooltip");return d(),c(M,null,[s(o(se),{title:S}),s(ae,{pagina:[{label:S,link:!1}]},{default:r(()=>[e("div",ce,[s(ne,{for:"file_input1",value:"Importar Stock",class:"block text-base font-medium leading-6 text-gray-900"}),e("input",{ref_key:"inputArchivo",ref:f,onInput:K,type:"file",class:"block w-full text-xs text-gray-500 file:mr-4 file:py-1.5 file:px-3 file:rounded file:border-0 file:text-sm file:font-medium file:bg-primary-900 file:text-white hover:file:bg-primary-900/80 hover:file:cursor-pointer file:disabled::opacity-75 file:disabled:cursor-no-drop disabled:opacity-75 disabled:cursor-no-drop",disabled:o(i).processing,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},null,40,de),s(ie,{class:"mt-1 text-xs",message:o(i).errors.archivo},null,8,["message"])]),e("div",ue,[e("div",pe,[s(o(m),{label:"Importar",type:"button",class:oe(["text-normal",{"opacity-50":o(i).processing}]),disabled:o(i).processing,onClick:z(Q,["prevent"])},null,8,["class","disabled","onClick"])])]),e("div",me,[e("div",fe,[s(o(m),{label:"Descargar formato",size:"md",severity:"success",type:"button",class:"p-1 text-xs font-light ring-0",onClick:l[0]||(l[0]=a=>J("importar_stock_productos.xlsx"))})])]),e("div",xe,[s(v),e("div",{class:"px-3 p-2 col-span-full flex justify-start items-center"},[e("h5",{class:"text-2xl font-medium pr-5"},_(S))]),e("div",he,[A((d(),c("span",ve,[e("a",{href:t.route("productos.exportar"),target:"_blank",class:"py-auto"},ge,8,be)])),[[j,{value:"Descargar Excel",pt:{text:"bg-gray-500 p-1 text-xs text-white rounded"}},void 0,{top:!0}]]),s(o(m),{size:"small",label:"Agregar Producto",severity:"success",onClick:q})]),e("div",ye,[s(W,{rowClass:P,filters:k.value,value:F.value,pt:{bodyRow:{class:"hover:cursor-pointer hover:bg-gray-100 hover:text-black"},root:{class:"w-auto"}},globalFilterFields:["codigo_barra","origen","nombre"],scrollable:"",scrollHeight:"700px",paginator:"",rows:50,onRowClick:H,size:"small"},{header:r(()=>[e("div",we,[s(C,{modelValue:k.value.global.value,"onUpdate:modelValue":l[1]||(l[1]=a=>k.value.global.value=a),placeholder:"Buscar"},null,8,["modelValue"])])]),empty:r(()=>[I(" No existe Resultado ")]),loading:r(()=>[I(" Cargando... ")]),default:r(()=>[s(o(u),{field:"stock",sortable:"",header:"Stock",pt:{bodyCell:{class:"text-center w-12"}}}),s(o(u),{field:"stock_futuro",sortable:"",header:"Stock futuro",pt:{bodyCell:{class:"text-center w-12"}}}),s(o(u),{field:"imagen",header:"Imagen",pt:{bodyCell:{class:"flex justify-center text-center w-12"},headerCell:{class:"w-10"}}},{loading:r(()=>[]),body:r(a=>[e("img",{class:"rounded bg-white shadow-2xl border-2 text-center w-10 h-10 object-contain",src:a.data.imagen,alt:"image"},null,8,ke)]),_:1}),s(o(u),{field:"origen",header:"Origen",sortable:"",pt:{bodyCell:{class:"text-center w-36"}}}),s(o(u),{field:"nombre",header:"Nombre",sortable:"",pt:{bodyCell:{class:"text-center"}}}),s(o(u),{header:"Acciones",style:{width:"80px"},class:"px-auto"},{loading:r(()=>[]),body:r(a=>[o(O).includes("eliminar-productos")?A((d(),c("button",{key:0,class:"w-8 h-8 rounded bg-red-700 border border-white px-2 py-1 text-base font-normal text-white m-1 hover:bg-red-600",onClick:z(Le=>U(a.data.id,a.data.nombre),["prevent"])},Fe,8,Ce)),[[j,{value:"Eliminar",pt:{text:"bg-gray-500 p-1 text-xs text-white rounded"}},void 0,{top:!0}]]):V("",!0)]),_:1})]),_:1},8,["filters","value"])])]),s(N,{visible:x.value,"onUpdate:visible":l[3]||(l[3]=a=>x.value=a),modal:"",style:{width:"30vw"},pt:{header:{class:"mt-5 pb-2 px-5"},content:{class:"p-4"}}},{header:r(()=>[ze]),default:r(()=>[w.value.length>0?(d(),c("div",De,[Te,e("table",Ne,[je,e("tbody",null,[(d(!0),c(M,null,le(w.value,a=>(d(),c("tr",Be,[e("td",Ee,_(a.fila),1),e("td",Me,_(a.sku),1)]))),256))])])])):V("",!0),e("div",Ae,[s(o(m),{label:"Aceptar",size:"small",type:"button",onClick:l[2]||(l[2]=a=>Z())})])]),_:1},8,["visible"]),s(N,{visible:h.value,"onUpdate:visible":l[5]||(l[5]=a=>h.value=a),modal:"",style:{width:"30vw"},pt:{header:{class:"mt-5 pb-2 px-5"},content:{class:"p-4"}}},{header:r(()=>[Ve]),default:r(()=>[e("div",null,[e("p",Ie,_(D.value),1)]),e("div",$e,[s(o(m),{label:"Aceptar",size:"small",type:"button",onClick:l[4]||(l[4]=a=>G())})])]),_:1},8,["visible"])]),_:1},8,["pagina"])],64)}}};export{Ze as default};
